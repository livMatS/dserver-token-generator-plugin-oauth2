#
# OAuth2 Token Generator Plugin Configuration
#
# Copy this file to .env and modify as needed
#

# =============================================================================
# OAuth2 Provider Configuration
# =============================================================================

# Provider name (for logging and display)
OAUTH2_PROVIDER_NAME=orcid

# Base URL of your dserver instance
OAUTH2_BASE_URL=https://dserver.example.com

# OAuth2 Endpoints
# For ORCID Production:
OAUTH2_AUTHORIZATION_URL=https://orcid.org/oauth/authorize
OAUTH2_TOKEN_URL=https://orcid.org/oauth/token
# OAUTH2_USERINFO_URL=  # Not needed for ORCID

# For ORCID Sandbox (testing):
# OAUTH2_AUTHORIZATION_URL=https://sandbox.orcid.org/oauth/authorize
# OAUTH2_TOKEN_URL=https://sandbox.orcid.org/oauth/token

# =============================================================================
# OAuth2 Client Credentials
# =============================================================================

# Get these from your OAuth2 provider's developer console
OAUTH2_CLIENT_ID=APP-XXXXXXXXXXXX
OAUTH2_CLIENT_SECRET=your-client-secret-here

# =============================================================================
# OAuth2 Settings
# =============================================================================

# Scopes to request (space-separated for most providers)
# ORCID uses: /authenticate
# GitHub uses: read:user user:email
# Google uses: openid email profile
OAUTH2_SCOPE=/authenticate

# Callback URL (usually auto-generated from BASE_URL)
# OAUTH2_REDIRECT_URI=${OAUTH2_BASE_URL}/auth/callback

# =============================================================================
# Attribute Mapping
# =============================================================================

# Map OAuth2 provider fields to internal user fields
# Format: provider_field:internal_field,provider_field2:internal_field2
#
# ORCID: orcid:user_id,name:display_name
# GitHub: id:user_id,login:username,email:email,name:display_name
# Google: sub:user_id,email:email,name:display_name
OAUTH2_ATTRIBUTE_MAP=orcid:user_id,name:display_name

# Which mapped field to use as the username
OAUTH2_USERNAME_FIELD=user_id

# =============================================================================
# JWT Configuration
# =============================================================================

# Path to JWT signing keys (same as dserver)
JWT_PRIVATE_KEY_FILE=/app/jwt/jwt_key
JWT_PUBLIC_KEY_FILE=/app/jwt/jwt_key.pub

# JWT algorithm
JWT_ALGORITHM=RS256

# Token issuer (should match dserver expectation)
JWT_ISSUER=dserver

# Token audience
JWT_AUDIENCE=dserver

# Token validity in hours
JWT_TOKEN_EXPIRY_HOURS=24

# =============================================================================
# User Provisioning
# =============================================================================

# Automatically create users on first login
OAUTH2_AUTO_PROVISION_USERS=true

# Default permissions for new users (comma-separated)
OAUTH2_DEFAULT_USER_PERMISSIONS=search,retrieve

# =============================================================================
# Redirect URLs
# =============================================================================

# Frontend base URL
OAUTH2_FRONTEND_URL=/

# Redirect after successful login
OAUTH2_LOGIN_SUCCESS_REDIRECT=/

# Redirect after failed login
OAUTH2_LOGIN_ERROR_REDIRECT=/login?error=auth_failed

# =============================================================================
# API Authentication (Optional)
# =============================================================================

# API key for programmatic token generation (leave empty to disable)
# OAUTH2_API_KEY=your-secure-api-key-here
